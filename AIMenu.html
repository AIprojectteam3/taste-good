<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 메뉴 추천</title>
    <link rel = "stylesheet" href = "css/menu.css">
    <link rel = "stylesheet" href = "css/AIMenu.css">

    <script src = "js/menu.js"></script>
    <script src = "js/AIMenu.js"></script>
    <script src = "//dapi.kakao.com/v2/maps/sdk.js?appkey=0ad0234b4cdaf5ff61c8c89276f01dcf&libraries=services&autoload=false"></script>
    <script src = "js/pointLogModal.js"></script>
</head>
<body>
    <div class = "container">
        <!-- 메뉴 영역 -->
        <aside class="menu">
            <section class="profile">
                <div class = "profile-header">
                    <div class="image">
                        <img src="image/profile-icon.png" alt="프로필 사진" />
                    </div>
                    <div class="nickname-container">
                        <span class="nickname">방문자</span>
                        <span class="email-text">방문자@맛잘알연구소.com</span>
                    </div>
                </div>
                <div class = "profile-stats">
                    <div class="level">
                        <div class = "level-header">
                            <div class = "level-text-container">
                                <span class="level-text-lv">Lv.</span>
                                <span class="level-text level-value">0</span>
                            </div>
                            <div class="level-icon-container">
                                <img class = "level_icon" src = "" alt = "레벨 아이콘">
                            </div>
                        </div>
                        <!-- 경험치 바 추가 -->
                        <div class="exp-bar-container">
                            <div class="exp-bar">
                                <div class="exp-progress" style="width: 0%"></div>
                            </div>
                            <div class="exp-text">
                                <span class="current-exp">0</span> / <span class="required-exp">100</span>
                            </div>
                        </div>
                    </div>
                    <div class = "user-info">
                        <div class="post">
                            <a href = "myprofile.html">
                                <span>Posts</span>
                                <span class = "post-count">0</span>
                            </a>
                        </div>
                        <div class="point" id = "pointLogBtn">
                            <a href = "#">
                                <span>Point</span>
                                <span class = "point-count">0</span>
                            </a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 차트 영역 -->
            <section class="chart">
                <div class="chart-header">
                    <h3>실시간 인기 검색어</h3>
                </div>
                <ol id="searchRankingList">
                    <!-- 순위 데이터가 여기에 동적으로 삽입됩니다 -->
                </ol>
            </section>

            <!-- 메인 메뉴 -->
            <nav class="main-menu">
                <ul>
                    <hr>
                    <li><a href = "index.html">
                        <img src = "image/popularity-icon.png" alt = "인기 메뉴">
                        <span>인기 메뉴</span>
                    </a></li>
                    <hr>
                    <li><a href = "AIMenu.html">
                        <img src = "image/ai-icon.png" alt = "AI 메뉴 추천">
                        <span>AI 메뉴 추천</span>
                    </a></li>
                    <hr>
                    <li><a href = "check-in.html">
                        <img src = "image/check-in.png" alt = "출석체크">
                        <span>출석체크</span>
                    </a></li>
                    <li><a href = "roulette.html">
                        <img src = "image/roulette-icon.png" alt = "룰렛">
                        <span>룰렛</span>
                    </a></li>
                    <li><a href = "tamagotchi.html">
                        <img src = "image/tamagotchi-icon.png" alt = "다마고치">
                        <span>다마고치</span>
                    </a></li>
                    <hr>
                    <li><a href = "myprofile.html">
                        <img src = "image/myprofile-icon.png" alt = "마이페이지">
                        <span>마이페이지</span>
                    </a></li>
                    <hr>
                    <li><a href = "#" class = "logoutPCMenu" onclick="handleLogout(event)">
                        <img src = "image/logout-icon.png" alt = "로그아웃">
                        <span>로그아웃</span>
                    </a></li>
                    <hr>
                </ul>
            </nav>
        </aside>

        <div class="content">
            <div class="recommender-container">
                <h2>AI 메뉴 추천 연구소</h2>
                <p>지금 당신의 상황과 조건에 딱 맞는 메뉴를 찾아보세요!</p>

                <div class="filters">
                    <!-- 1. 카테고리 필터 -->
                    <div class="filter-group">
                        <label>어떤 종류의 음식을 원하세요?</label>
                        <div id = "categories-container" class="checkbox-container"></div>
                    </div>
                    <!-- 2. 유저 기분 필터 -->
                    <div class="filter-group">
                        <label>어떤 상황인가요?</label>
                        <div id = "needs-container" class="checkbox-container"></div>
                    </div>
                    <!-- 3. 원하는 기분 필터 -->
                    <div class="filter-group">
                        <label>무엇을 원하세요?</label>
                        <div id = "goals-container" class="checkbox-container"></div>
                    </div>
                    <!-- 계절 -->
                    <div class="filter-group">
                        <label>어느 계절인가요?</label>
                        <div id = "season-container" class="checkbox-container"></div>
                    </div>
                    <!-- 4. 날씨 필터 -->
                    <div class="filter-group">
                        <label>날씨는 어떤가요?</label>
                        <div id = "weathers-container" class="checkbox-container"></div>
                    </div>
                    <!-- 시간대 필터 -->
                    <div class="filter-group">
                        <label>언제 드실 건가요?</label>
                        <div class="checkbox-container" id="times-container">
                            <!-- 시간대 체크박스가 여기에 동적으로 생성됩니다 -->
                        </div>
                    </div>
                    <div class = "sliderDiv">
                        <!-- 5. 칼로리 필터 -->
                        <div class="filter-group range-slider-group">
                            <label for="kcal-slider">칼로리 (최대)</label>
                            <input type="range" id="kcal-slider" name="kcal" min="0" max="2000" value="2000" step="50">
                            <span class = "slider-value" id="kcal-value">상관없음</span>
                        </div>
                        <!-- 6. 가격 필터 -->
                        <div class="filter-group range-slider-group">
                            <label for="price-slider">가격 (최대)</label>
                            <input type="range" id="price-slider" name="price" min="0" max="50000" value="50000" step="1000">
                            <span class = "slider-value" id="price-value">상관없음</span>
                        </div>
                    </div>
                    <div class = "sliderDiv">
                        <div class="filter-group range-slider-group">
                            <label for="people-slider">인원 수</label>
                            <input type="range" id="people-slider" min="1" max="8" value="1" class="slider">
                            <span class = "slider-value" id="people-value">2명</span>
                        </div>
                        <div class="filter-group range-slider-group">
                            <label for="menu-count-slider">추천받을 메뉴 수</label>
                            <input type="range" id="menu-count-slider" min="1" max="10" value="1" class="slider">
                            <span class = "slider-value" id="menu-count-value">3개</span>
                        </div>
                    </div>
                    <div class = "sliderDiv">
                        <div class="filter-group" id="user-allergen-info" style="display: none;">
                            <label>등록된 알레르기 정보</label>
                            <div class="user-allergen-display" id="user-allergen-display">
                                <!-- 사용자 알레르기 정보가 여기에 표시됨 -->
                            </div>
                        </div>
                    </div>
                </div>

                <button id="get-recommendation-btn">AI 메뉴 추천받기</button>

                <div id="recommendation-results"></div>
                <div id="loading-spinner" class="spinner" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- 메뉴 상세 정보 모달 -->
    <div id="menu-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-menu-title">메뉴 상세 정보</h2>
                <span class="close-button">&times;</span>
            </div>
            <div class="modal-body">
                <div id="modal-left">
                    <img id="modal-menu-image" src="" alt="메뉴 이미지" style="display: none;">
                    <div class="menu-info">
                        <h3 id="modal-menu-name"></h3>
                        <p><strong>카테고리 :</strong> <span id="modal-menu-category"></span></p>
                        <p><strong>칼로리 :</strong> <span id="modal-menu-kcal"></span></p>
                        <p><strong>가격 :</strong> <span id="modal-menu-price"></span></p>
                        <div class="allergen-info-section">
                            <p><strong>알레르기 정보</strong></p>
                            <div id="modal-menu-allergens" class="user-allergen-display">
                                <!-- 알레르기 정보가 여기에 동적으로 삽입됩니다 -->
                            </div>
                        </div>
                        <div class="info-disclaimer">
                            <p class="disclaimer-text">칼로리, 가격, 알레르기 정보는 참고용이니 실제 정보는 해당 식당에 문의해주세요.</p>
                        </div>
                    </div>
                    
                    <!-- GPT 응답 섹션 추가 -->
                    <div id="modal-gpt-section" class="gpt-section" style="display: none;">
                        <h4>🤖 AI 추천 이유</h4>
                        <div id="modal-gpt-response" class="gpt-response-content"></div>
                        <div id="modal-pair-response" class="gpt-response-content"></div>
                        <div id="modal-fallback-info" class="fallback-info" style="display: none;"></div>
                    </div>
                </div>
                <div id="modal-right">
                    <div id="map" style="width: 100%; height: 100%;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 모바일 네비게이션 -->
    <nav class="bottom-nav">
        <div class = "hamburger-menu" id = "hamburgerMenu">
            <img src = "image/menu-icon.png" alt = "메뉴 아이콘">
        </div>
        <div class = "site-title">맛잘알연구소</div>

        <div class="mobile-menu" id="mobileMenu">
            <ul class="mobile-menu-list">
                <li><a href="index.html">인기메뉴</a></li>
                <li><a href="AIMenu.html">AI 메뉴 추천</a></li>
                <li><a href="roulette.html">룰렛</a></li>
                <li><a href="tamagotchi.html">다마고치</a></li>
                <li><a href="myprofile.html">마이페이지</a></li>
                <li><a href="#" class = "logoutMenu" onclick="handleLogout(event)">로그아웃</a></li>
            </ul>
        </div>
    </nav>
</body>
</html>